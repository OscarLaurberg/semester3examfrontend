(this.webpackJsonpreact_template=this.webpackJsonpreact_template||[]).push([[0],{197:function(e,t,a){e.exports=a(337)},335:function(e,t,a){},337:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(33),c=a.n(l),o=a(22),i=a(351),u=a(338),s=a(347),m=a(58),d=a.n(m),p=a(84),E=a(16),f=a(37),g=function(e){return e.ok?e.json():Promise.reject({status:e.status,fullError:e.json()})},h={fetchData:function(){var e=Object(p.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://laurberg.codes/sem3exambackend/api").concat(t),a);case 2:return n=e.sent,e.abrupt("return",g(n));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),handleHttpErrors:g,makeOptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={method:e,headers:{"Content-type":"application/json",Accept:"application/json"}};return a&&(n.headers["x-access-token"]=localStorage.getItem("jwtToken")),t&&(n.body=JSON.stringify(t)),n}},v=function(e){var t=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(a)}(e),a=t.roles.split(",");return{username:t.username,roles:a}},b=Object(n.createContext)(),j=function(){return Object(n.useContext)(b)},O=function(e){var t=e.children,a=function(){var e=Object(n.useState)(null),t=Object(E.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(),c=Object(E.a)(l,2),o=c[0],i=c[1],u=Object(n.useState)(null),s=Object(E.a)(u,2),m=s[0],g=s[1],b=Object(n.useState)(),j=Object(E.a)(b,2),O=j[0],y=j[1],S=Object(n.useState)(!1),k=Object(E.a)(S,2),x=k[0],I=k[1],T=Object(f.g)();Object(n.useEffect)((function(){if(i(localStorage.getItem("jwtToken")),y(!!o),o){var e=v(o),t=e.username,a=e.roles;g(t),r(a)}}),[o]);return{user:{name:m,roles:a,authenticateRole:function(e){return O&&a.includes(e)},jwtToken:o,isLoggedIn:O},signIn:function(){var e=Object(p.a)(d.a.mark((function e(t,a){var n,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.makeOptions("POST",{username:t,password:a}),e.prev=1,I(!0),e.next=5,h.fetchData("/login",n);case 5:l=e.sent,g(l.username),i(l.token),localStorage.setItem("jwtToken",l.token),r(l.roles),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),e.t0.status?e.t0.fullError.then((function(e){return alert(e.message)})):console.log("Network error");case 15:return e.prev=15,I(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})));return function(t,a){return e.apply(this,arguments)}}(),signOut:function(){g(null),i(null),localStorage.removeItem("jwtToken"),T.push("/")},isLoading:x}}();return r.a.createElement(b.Provider,{value:a},t)},y=function(e){var t=e.toggler,a=e.content,l=Object(n.useState)(!1),c=Object(E.a)(l,2),o=c[0],i=c[1];return r.a.createElement(r.a.Fragment,null,t((function(){return i(!0)})),o&&a((function(){return i(!1)})))},S=document.querySelector("#modal"),k=function(e){var t=e.children,a=e.hideModal,r=document.createElement("div");return Object(n.useEffect)((function(){return S.appendChild(r),document.addEventListener("keydown",(function(e){27===e.keyCode&&a()})),function(){return S.removeChild(r)}}),[r,a]),Object(l.createPortal)(t,r)},x=a(87),I=a(64),T=a(352),w=a(353),C=a(348),A=a(354),R=a(350);function D(e){var t=e.hideModal,a=j(),l=a.signIn,c=a.isLoading,i=Object(n.useState)({username:"",password:""}),s=Object(E.a)(i,2),m=s[0],d=s[1],p=function(e){d(Object(I.a)({},m,Object(x.a)({},e.target.id,e.target.value)))};return r.a.createElement(T.a,{textAlign:"center",style:{height:"50vh",width:"50vh"},verticalAlign:"middle"},r.a.createElement(T.a.Column,{style:{maxWidth:450}},r.a.createElement(w.a,{as:"h2",color:"blue",textAlign:"center"},"Welcome back. Sign in below!"),r.a.createElement(C.a,{size:"large"},r.a.createElement(A.a,{stacked:!0},r.a.createElement(C.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"Username",id:"username",onChange:p,value:m.username}),r.a.createElement(C.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",id:"password",onChange:p,value:m.password}),r.a.createElement(u.a,{loading:c,onClick:function(e){e.preventDefault(),l(m.username,m.password),t()},color:"blue",fluid:!0,size:"large"},"Login"))),r.a.createElement(R.a,null,"New User? ",r.a.createElement(o.b,{to:"/signup"},"Sign up!"))))}var M=function(e){var t=e.hideModal,a=j(),n=a.isLoading,l=a.signOut;return r.a.createElement(T.a,{textAlign:"center",style:{height:"50vh",width:"50vh"},verticalAlign:"middle"},r.a.createElement(T.a.Column,{style:{maxWidth:450}},r.a.createElement(w.a,{as:"h2",color:"blue",textAlign:"center"},"We are sad to see you leave - Are you sure you want to sign out?"),r.a.createElement(u.a,{loading:n,onClick:function(){l(),t()},color:"blue",fluid:!0,size:"large"},"Sign out")))},P=function(){var e=j().user.isLoggedIn;return r.a.createElement(y,{toggler:function(t){return function(t){var a=e?"Logout":"Login";return r.a.createElement(u.a,{style:{marginRight:"0.5em"},onClick:t},a)}(t)},content:function(t){return function(t){return r.a.createElement(k,{hideModal:t},e?r.a.createElement(M,{hideModal:t}):r.a.createElement(D,{hideModal:t}))}(t)}})};var L=function(){var e=j().user,t=e.isLoggedIn,a=e.name,n=e.authenticateRole;return r.a.createElement(i.a,null,r.a.createElement(s.a,null,r.a.createElement(i.a.Item,{as:o.c,exact:!0,to:"/",name:"home"},"Home"),!(n("admin")||n("user"))&&r.a.createElement(i.a.Item,{as:o.c,exact:!0,to:"/movieInfo",name:"movieInfo"},"Movie info"),(n("admin")||n("user"))&&r.a.createElement(i.a.Item,{as:o.c,exact:!0,to:"/detailedMovieInfo",name:"detailedMovieInfo"},"Movie info VIP"),n("admin")&&r.a.createElement(i.a.Item,{as:o.c,exact:!0,to:"/movieCount",name:"movieCount"},"Movie count"),t?r.a.createElement(i.a.Item,{position:"right"},r.a.createElement(u.a,{content:a,icon:"user",primary:!0,style:{marginRight:"0.5em"}}),r.a.createElement(P,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a.Item,{position:"right"},r.a.createElement(u.a,{as:o.b,to:"/signup",primary:!0,style:{marginRight:"0.5em"}},"Sign Up"),r.a.createElement(P,null)))))},_=a(185),F=function(e){var t=e.children,a=e.authenticatedRoles,n=Object(_.a)(e,["children","authenticatedRoles"]),l=j().user,c=l.isLoggedIn,o=l.roles;return r.a.createElement(f.b,Object.assign({},n,{render:function(){return c&&o.some((function(e){return a.indexOf(e)>=0}))?t:r.a.createElement(f.a,{to:{pathname:"/unauthorized"}})}}))};function N(){return r.a.createElement("h1",null,"No pages matches this path")}function U(){return r.a.createElement("h1",null,"Home")}var z=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Unauthorized - Please Login"),r.a.createElement(P,null))},B=a(346);function H(){var e=r.a.useState(""),t=Object(E.a)(e,2),a=t[0],n=t[1],l=r.a.useState({}),c=Object(E.a)(l,2),o=c[0],i=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{marginBottom:20}},r.a.createElement(B.a,{placeholder:"movie title",value:a,onChange:function(e){return n(e.target.value)}}),r.a.createElement(u.a,{content:"Primary",disabled:a.length<=0,onClick:function(){var e=h.makeOptions("GET");h.fetchData("/movie-info/".concat(a),e).then((function(e){i(e)})).catch(console.log)}},"Submit")),o.poster&&r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,r.a.createElement("img",{alt:"poster",style:{maxHeight:"300px"},src:o.poster})),r.a.createElement("div",{style:{padding:20}},r.a.createElement("h2",{style:{margin:0}},o.title," (",o.year,")"),r.a.createElement("p",null,o.genres),r.a.createElement("p",null,r.a.createElement("b",null,"Plot: "),o.plot),r.a.createElement("p",null,r.a.createElement("b",null,"Director: "),o.directors),r.a.createElement("p",null,r.a.createElement("b",null,"Actors: ")),r.a.createElement("ul",null,o.cast.split(",").map((function(e){return r.a.createElement("li",{key:e},e)}))))))}function W(){var e=r.a.useState(""),t=Object(E.a)(e,2),a=t[0],n=t[1],l=r.a.useState({}),c=Object(E.a)(l,2),o=c[0],i=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{marginBottom:20}},r.a.createElement(B.a,{placeholder:"movie title",value:a,onChange:function(e){return n(e.target.value)}}),r.a.createElement(u.a,{content:"Primary",primary:!0,disabled:a.length<=0,onClick:function(){var e=h.makeOptions("GET");h.fetchData("/movie-info-all-ratings/".concat(a),e).then((function(e){i(e)})).catch(console.log)}},"Submit")),o.poster&&r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,r.a.createElement("img",{alt:"poster",style:{maxHeight:"300px"},src:o.poster})),r.a.createElement("div",{style:{padding:20}},r.a.createElement("h2",{style:{margin:0}},o.title," (",o.year,")"),r.a.createElement("p",null,o.genres),r.a.createElement("p",{style:{maxWidth:"400px"}},r.a.createElement("b",null,"Plot: "),o.plot),r.a.createElement("p",null,r.a.createElement("b",null,"Director: "),o.directors),r.a.createElement("p",null,r.a.createElement("b",null,"Actors: ")),r.a.createElement("ul",null,o.cast.split(",").map((function(e){return r.a.createElement("li",{key:e},e)}))),r.a.createElement("p",null,"Rotten tomatoes score: ",o.tomatoRating," / 10"),r.a.createElement("p",null,"IMDB score: ",o.imdbRating," / 10"),r.a.createElement("p",null,"Metacritis score: ",o.metacriticRating," / 100"))))}function J(){var e=r.a.useState(""),t=Object(E.a)(e,2),a=t[0],n=t[1],l=r.a.useState(),c=Object(E.a)(l,2),o=c[0],i=c[1],s=r.a.useState(),m=Object(E.a)(s,2),d=m[0],p=m[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{marginBottom:20}},r.a.createElement(B.a,{placeholder:"movie title",value:a,onChange:function(e){return n(e.target.value)}}),r.a.createElement(u.a,{content:"Primary",primary:!0,disabled:a.length<=0,onClick:function(){var e=h.makeOptions("GET");h.fetchData("/movie-count/".concat(a),e).then((function(e){p(e),i(a)})).catch(console.log)}},"Submit")),d&&r.a.createElement("h3",null,'Title: "'.concat(o,'" have been searched for ').concat(d," times")))}var G=function(){return r.a.createElement(f.d,null,r.a.createElement(f.b,{exact:!0,path:"/"},r.a.createElement(U,null)),r.a.createElement(f.b,{path:"/movieInfo"},r.a.createElement(H,null)),r.a.createElement(F,{authenticatedRoles:["admin","user"],path:"/detailedMovieInfo"},r.a.createElement(W,null)),r.a.createElement(F,{authenticatedRoles:["admin"],path:"/movieCount"},r.a.createElement(J,null)),r.a.createElement(f.b,{path:"/unauthorized"},r.a.createElement(z,null)),r.a.createElement(f.b,null,r.a.createElement(N,null)))},V=a(123),q=a(47),K=a(66),Q=a.n(K),X=Object(n.createContext)(),Y={past:[],present:[{id:Q()(),name:"test1",age:20,email:"hej@hej1.dk"},{id:Q()(),name:"test2",age:21,email:"hej@hej2.dk"},{id:Q()(),name:"test3",age:22,email:"hej@hej3.dk"}],future:[]},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;if("STATE_ADD"===t.type){var a=[Object(I.a)({id:Q()()},t.payload)].concat(Object(q.a)(e.present));return{past:[e.present].concat(Object(q.a)(e.past)),present:a,future:[]}}if("STATE_REMOVE"===t.type){var n=e.present.filter((function(e){return e.id!==t.payload.id}));return{past:[e.present].concat(Object(q.a)(e.past)),present:n,future:[]}}if("STATE_UNDO"===t.type){var r=Object(V.a)(e.past),l=r[0],c=r.slice(1);return{past:c,present:l,future:[e.present].concat(Object(q.a)(e.future))}}if("STATE_REDO"===t.type){var o=Object(V.a)(e.future),i=o[0],u=o.slice(1);return{past:[e.present].concat(Object(q.a)(e.past)),present:i,future:Object(q.a)(u)}}return e},$=function(e){var t=e.children,a=Object(n.useReducer)(Z,Y),l=Object(E.a)(a,2),c=l[0],o=l[1],i={stateObjects:c.present,addState:function(e){o({type:"STATE_ADD",payload:Object(I.a)({},e)})},RemoveState:function(e){o({type:"STATE_REMOVE",payload:{id:e}})},undoState:function(){o({type:"STATE_UNDO"})},redoState:function(){o({type:"STATE_REDO"})},isPast:!!c.past.length,isFuture:!!c.future.length};return r.a.createElement(X.Provider,{value:i},t)};var ee=function(){return r.a.createElement($,null,r.a.createElement(O,null,r.a.createElement(L,null),r.a.createElement(s.a,null,r.a.createElement(G,null))))},te=(a(335),a(336),function(){return r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,null,r.a.createElement(ee,null)))});c.a.render(r.a.createElement(te,null),document.getElementById("root"))}},[[197,1,2]]]);
//# sourceMappingURL=main.5dc18678.chunk.js.map